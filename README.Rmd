---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit the README.Rmd file -->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(Lahman)
```

# Lab report #4 - instructions

Follow the instructions posted at <https://ds202-at-isu.github.io/labs.html> for the lab assignment. The work is meant to be finished during the lab time, but you have time until Monday (after Thanksgiving) to polish things.

All submissions to the github repo will be automatically uploaded for grading once the due date is passed. Submit a link to your repository on Canvas (only one submission per team) to signal to the instructors that you are done with your submission.

# Lab 4: Scraping (into) the Hall of Fame

```{r}
# Scraping pulled from the lab manual

library(rvest)
url <- "https://www.baseball-reference.com/awards/hof_2023.shtml"
html <- read_html(url)
tables <- html_table(html)

head(tables[[1]], 3)
```
```{r}
# Creating column names pulled from the lab manual
write.csv(tables[[1]], "temp.csv", row.names=FALSE)
add_hof <- readr::read_csv("temp.csv", skip = 1, show_col_types =FALSE)

# Making table into an identical dataframe to work with
add_hof <- data.frame(rbind(add_hof))
colnames(add_hof)[5] <- "%.vote"

head(add_hof, 3)


```


```{r}
# Cleaning %.vote column into numerical variable 
add_hof <- add_hof %>% 
  mutate(`%.vote` = parse_number(`%.vote`))

# Cleaning X from player names
add_hof <- add_hof %>% 
  mutate(Name = gsub("X-", "", Name))

# Adding a yearID column since it is not already there from scraping (prepping for eventual join)
add_hof <- add_hof %>% 
  mutate(yearID = 2023)


```




```{r}
# Preparing add_hof for joining with People from Lahman set
add_hof <- add_hof %>% 
  separate(col=Name, into=c('nameFirst', 'nameLast'), sep=' ') 

head(add_hof, 3)
```

```{r}
# Adding PlayerID to scraped data
modPeop <- People %>% 
  select(nameFirst, nameLast, playerID)

# This join automatically eliminates any players without playerIDs in the Lahman database (removing 4 players)
add_hof <- inner_join(add_hof, modPeop, by = c("nameFirst", "nameLast"))

head(add_hof)
```

```{r}
# adding new data to old HallOfFame from Lahman
new_hof <- full_join(add_hof, HallOfFame, by = c("playerID", "yearID"))

# ordering the yearID from newest to oldest (to show our additions)
new_hof <- new_hof[order(new_hof$yearID, decreasing = TRUE),]

new_hof

# creating csv
write.csv(new_hof, file="HallOfFame.csv", row.names = FALSE)

```






